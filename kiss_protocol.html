<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>KISS Protocol &mdash; M17 Protocol Specification  documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="M17 Internet Protocol (IP) Networking" href="ip_encapsulation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> M17 Protocol Specification
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Part I - Air and IP Interface:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="summary.html">M17 RF Protocol: Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="physical_layer.html">Physical Layer</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_link_layer.html">Data Link Layer</a></li>
<li class="toctree-l1"><a class="reference internal" href="application_layer.html">Application Layer</a></li>
</ul>
<p class="caption"><span class="caption-text">Part II - Codeplug:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="codeplug.html">Recommendation for the codeplug structure</a></li>
</ul>
<p class="caption"><span class="caption-text">Appendix:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="address_encoding.html">Address Encoding</a></li>
<li class="toctree-l1"><a class="reference internal" href="decorrelator.html">Decorrelator sequence</a></li>
<li class="toctree-l1"><a class="reference internal" href="interleaving.html">Interleaving</a></li>
<li class="toctree-l1"><a class="reference internal" href="ip_encapsulation.html">M17 Internet Protocol (IP) Networking</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">KISS Protocol</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="#glossary">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="#m17-protocols">M17 Protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="#kiss-basics">KISS Basics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tx-delay">TX Delay</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#packet-protocols">Packet Protocols</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#m17-basic-packet-mode">M17 Basic Packet Mode</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sending-data">Sending Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#limitations">Limitations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#receiving-data">Receiving Data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#m17-full-packet-mode">M17 Full Packet Mode</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Receiving Data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#stream-protocol">Stream Protocol</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#stream-format">Stream Format</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-frames">Data Frames</a></li>
<li class="toctree-l3"><a class="reference internal" href="#timing-constraints">Timing Constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tnc-to-host-transfers">TNC to Host Transfers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#busy-channel-lockout">Busy Channel Lockout</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Limitations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#mixing-modes">Mixing Modes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#back-to-back-transfers">Back-to-back Transfers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#implementation-details">Implementation Details</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#polarity">Polarity</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">M17 Protocol Specification</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>KISS Protocol</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/kiss_protocol.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="kiss-protocol">
<h1>KISS Protocol<a class="headerlink" href="#kiss-protocol" title="Permalink to this headline"></a></h1>
<p>The purpose of this appendix is to document conventions for adapting KISS TNCs
to M17 packet and streaming modes.  M17 is a more complex protocol, both at
the baseband level and at the data link layer than is typical for HDLC-based
protocols commonly used on KISS TNCs.  However, it is well suited for modern
packet data links, and can even be used to stream digital audio between a host
and a radio.</p>
<p>This appendix assumes the reader is familiar with the streaming and packet
modes defined in the M17 spec, and with KISS TNCs and the KISS protocol.</p>
<p>In all cases, the TNC expects to get the data payload to be sent and is
responsible for frame construction, FEC encoding, puncturing, interleaving
and decorrelation.  It is also responsible for baseband modulation.</p>
<p>For streaming modes, all voice encoding (Codec2) is done on the host and
not on the TNC.  The host is also responsible for constructing the LICH.</p>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline"></a></h2>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="http://www.ax25.net/kiss.aspx">http://www.ax25.net/kiss.aspx</a></p></li>
<li><p><a class="reference external" href="https://packet-radio.net/wp-content/uploads/2017/04/multi-kiss.pdf">https://packet-radio.net/wp-content/uploads/2017/04/multi-kiss.pdf</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/OSI_model">https://en.wikipedia.org/wiki/OSI_model</a></p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="glossary">
<h2>Glossary<a class="headerlink" href="#glossary" title="Permalink to this headline"></a></h2>
<dl class="glossary simple">
<dt id="term-tnc">TNC</dt><dd><p>Terminal node controller – a baseband network interface device to allow
host computers to send data over a radio network, similar to a modem. It
connects a computer to a radio and handles the baseband portion of the
physical layer and the data link layer of network protocol stack.</p>
</dd>
<dt id="term-kiss">KISS</dt><dd><p>Short for “Keep it simple, stupid”.  A simplified TNC protocol designed
to move everything except for the physical layer and the data link layer
out of the TNC.  Early TNCs could include everything up through the
application layer of the OSI network model.</p>
</dd>
<dt id="term-slip">SLIP</dt><dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Serial_Line_Internet_Protocol">Serial Line Internet Protocol</a> –
the base protocol used by the KISS protocol, extended by adding a single
<a class="reference internal" href="#term-type-indicator"><span class="xref std std-term">type indicator</span></a> byte at the start of a frame.</p>
</dd>
<dt id="term-type-indicator">type indicator</dt><dd><p>A one byte code at the beginning of a KISS frame which indicates the TNC
<a class="reference internal" href="#term-port"><span class="xref std std-term">port</span></a> and KISS <a class="reference internal" href="#term-command"><span class="xref std std-term">command</span></a>.</p>
</dd>
<dt id="term-port">port</dt><dd><p>A logical port on a TNC. This allowed a single TNC to connect to multiple
radios.  Its specific use is loosely defined in the KISS spec.  The high
nibble of the KISS <a class="reference internal" href="#term-type-indicator"><span class="xref std std-term">type indicator</span></a>.  Port 0xF is reserved.</p>
</dd>
<dt id="term-command">command</dt><dd><p>A KISS command. This tells the TNC or host how to interpret the KISS
frame contents.  The low nibble of the KISS <a class="reference internal" href="#term-type-indicator"><span class="xref std std-term">type indicator</span></a>.
Command 0xF is reserved.</p>
</dd>
<dt id="term-csma">CSMA</dt><dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Carrier-sense_multiple_access">Carrier-sense multiple access</a> –
a protocol used by network devices to minimize collisions on a shared
communications channel.</p>
</dd>
<dt id="term-hdlc">HDLC</dt><dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/High-Level_Data_Link_Control">High-Level Data Link Control</a> –
a data link layer framing protocol used in many AX.25 packet radio
networks.  Many existing protocol documents, including KISS, reference
HDLC because of its ubiquity when the protocols were invented.  However,
HDLC is not a requirement for higher level protocols like KISS which
are agnostic to the framing used at the data link layer.</p>
</dd>
<dt id="term-eos">EOS</dt><dd><p>End of stream – an indicator bit in the frame number field of a stream
data frame.</p>
</dd>
<dt id="term-lich">LICH</dt><dd><p>Link information channel – a secondary data channel in the stream data
frame containing supplemental information, including a copy of the link
setup frame.</p>
</dd>
</dl>
</div>
<div class="section" id="m17-protocols">
<h2>M17 Protocols<a class="headerlink" href="#m17-protocols" title="Permalink to this headline"></a></h2>
<p>This specification defines KISS TNC modes for M17 packet and streaming modes,
allowing the KISS protocol to be used to send and receive M17 packet and voice
data. Both are bidirectional.  There are two packet modes defined. This is done
to provide complete access to the M17 protocol while maintaining the greatest
degree of backwards compatibility with existing packet applications.</p>
<p>These protocols map to specific KISS <a class="reference internal" href="#term-port"><span class="xref std std-term">port</span></a>.  The host tells the TNC what
type of data to transmit based on the port used in host to TNC transfers. And
the TNC tells the host what data it has received by the port set on TNC to
host transfers.</p>
<p>This document outlines first the two packet protocols, followed by the
streaming protocol.</p>
</div>
<div class="section" id="kiss-basics">
<h2>KISS Basics<a class="headerlink" href="#kiss-basics" title="Permalink to this headline"></a></h2>
<div class="section" id="tx-delay">
<h3>TX Delay<a class="headerlink" href="#tx-delay" title="Permalink to this headline"></a></h3>
<p>If a KISS <strong>TX delay</strong> <span class="math notranslate nohighlight">\(T_d\)</span> greater than 0 is specified, the transmitter
is keyed for <span class="math notranslate nohighlight">\(T_d * 10 ms\)</span> with only a DC signal present.</p>
<p>The <span class="math notranslate nohighlight">\(T_d\)</span> value should be adjusted to the minimum required by the
transmitter in order to transmit the full preamble reliably.</p>
<p>Only a single 40ms preamble frame is ever sent.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A TX delay may be necessary because many radios require some time between
when PTT is engaged and the transmitter can begin transmitting a modulated
signal.</p>
</div>
</div>
</div>
<div class="section" id="packet-protocols">
<h2>Packet Protocols<a class="headerlink" href="#packet-protocols" title="Permalink to this headline"></a></h2>
<p>In order to provide backward compatibility with the widest range of existing
ham radio software, and to make use of features in the the M17 protocol
itself, we will define two distint packet interfaces <em>BASIC</em> and <em>FULL</em>.</p>
<p>The KISS protocol allows us to target specific modems using the port
identifier in the control byte.</p>
<p>We first define basic packet mode as this is initially likely to be the
most commonly used mode over KISS.</p>
<div class="section" id="m17-basic-packet-mode">
<h3>M17 Basic Packet Mode<a class="headerlink" href="#m17-basic-packet-mode" title="Permalink to this headline"></a></h3>
<p>Basic packet mode uses only the standard KISS protocol on <strong>TNC port</strong> 0.
This is the default port for all TNCs.  Packets are sent using command 0.
Again, this is normal behavior for KISS client applications.</p>
<div class="section" id="sending-data">
<h4>Sending Data<a class="headerlink" href="#sending-data" title="Permalink to this headline"></a></h4>
<p>In basic mode, the TNC only expects to receive packets from the host, as it
would for any other mode supported AFSK, G3RUH, etc.</p>
<p>If the TNC is configured for half-duplex, the TNC will do P-persistence CSMA
using a 40ms slot time and obey the P value set via the KISS interface.  CSMA
is disabled in full-duplex mode.</p>
<p>The <strong>TX Tail</strong> value is deprecated and is ignored.</p>
<p>The TNC sends the preamble burst.</p>
<p>The TNC is responsible for constructing the link setup frame, identifying the
content as a raw mode packet.  The source field is an encoded TNC identifier,
similar to the APRS TOCALL, but it can be an arbitrary text string up to 9
characters in length.  The destination is set to the broadcast address.</p>
<p>In basic packet mode, it is expected that the sender callsign is embedded within
the packet payload.</p>
<p>The TNC sends the link setup frame.</p>
<p>The TNC then computes the CRC for the full packet, splits the packet into data
frames encode and modulate each frame back-to-back until the packet is
completely transmitted.</p>
<p>If there is another packet to be sent, the preamble can be skipped and the
TNC will construct the next link setup frame (it can re-use the same link
setup frame as it does not change) and send the next set of packet frames.</p>
</div>
<div class="section" id="limitations">
<h4>Limitations<a class="headerlink" href="#limitations" title="Permalink to this headline"></a></h4>
<p>The KISS specification defines no limitation to the packet size allowed.  Nor
does it specify any means of returning error conditions back to the host.
M17 packet protocol limits the raw packet payload size to 798 bytes.  The
TNC must drop any packets larger than this.</p>
</div>
<div class="section" id="receiving-data">
<h4>Receiving Data<a class="headerlink" href="#receiving-data" title="Permalink to this headline"></a></h4>
<p>When receiving M17 data, the TNC must receive and parse the link setup frame
and verify that the following frames contain raw packet data.</p>
<p>The TNC is responsible for decoding each packet, assembling the packet from
the sequence of frames received, and verifying the packet checksum.  If the
checksum is valid, the TNC transfers the packet, excluding the CRC to the host
using <strong>KISS port</strong> 0.</p>
</div>
</div>
<div class="section" id="m17-full-packet-mode">
<h3>M17 Full Packet Mode<a class="headerlink" href="#m17-full-packet-mode" title="Permalink to this headline"></a></h3>
<p>The purpose of full packet mode is to provide access to the entire M17 packet
protocol to the host.  This allows the host to set the source and destination
fields, filter received packets based on the content these fields, enable
encryption, and send and receive type-coded frames.</p>
<p>Use M17 full packet mode by sending to <strong>KISS port</strong> 1.  In this mode the host
is responsible for sending both the link setup frame and the packet data.  It
does this by prepending the 30-byte link setup frame to the packet data,
sending this to the TNC in a single KISS frame.  The TNC uses the first 30
bytes as the link setup frame verbatim, then splits the remaining data into
M17 packet frames.</p>
<p>As with basic mode, the TNC uses the <strong>Duplex</strong> setting to enable/disable CSMA,
and uses the <strong>P value</strong> for CSMA, with a fixes slot time of “4” (40 ms).</p>
<div class="section" id="id1">
<h4>Receiving Data<a class="headerlink" href="#id1" title="Permalink to this headline"></a></h4>
<p>For TNC to host transfers, the same occurs.  The TNC combines the link setup
frame with the packet frame and sends both in one KISS frame to the host using
<strong>KISS port</strong> 1.</p>
</div>
</div>
</div>
<div class="section" id="stream-protocol">
<h2>Stream Protocol<a class="headerlink" href="#stream-protocol" title="Permalink to this headline"></a></h2>
<p>The streaming protocol is fairly trivial to describe.  It is used by sending
first a link setup frame followed by a stream of 26-byte data frames to
<strong>KISS port</strong> 2.</p>
<div class="section" id="stream-format">
<h3>Stream Format<a class="headerlink" href="#stream-format" title="Permalink to this headline"></a></h3>
<table class="docutils align-default" id="id3">
<caption><span class="caption-number">Table 32 </span><span class="caption-text">M17 KISS Stream Protocol</span><a class="headerlink" href="#id3" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Frame Size</p></th>
<th class="head"><p>Contents</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>30</p></td>
<td><p>Link Setup Frame</p></td>
</tr>
<tr class="row-odd"><td><p>26</p></td>
<td><p>LICH + Payload</p></td>
</tr>
<tr class="row-even"><td><p>26</p></td>
<td><p>LICH + Payload</p></td>
</tr>
<tr class="row-odd"><td><p>…</p></td>
<td><p>…</p></td>
</tr>
<tr class="row-even"><td><p>26</p></td>
<td><p>LICH + Payload with EOS bit set.</p></td>
</tr>
</tbody>
</table>
<p>The host must not send any frame to any other KISS port while a stream is
active (a frame with the EOS bit has not been sent).</p>
<p>It is a protocol violation to send anything other than a link setup frame with
the stream mode bit set in the first field as the first frame in a stream
transfer to KISS port 2.  Any such frame is ignored.</p>
<p>It is a protocol violation to send anything to any other KISS port while a
stream is active.  If that happens the stream is terminated and the packet
that caused the protocol violation is dropped.</p>
</div>
<div class="section" id="data-frames">
<h3>Data Frames<a class="headerlink" href="#data-frames" title="Permalink to this headline"></a></h3>
<p>The data frames contain a 6-byte (48-bit) LICH segment followed by a 20 byte
payload segment consisting of frame number, 16-byte data payload and CRC. The
TNC is responsible for parsing the frame number and detecting the end-of-stream
bit to stop transmitting.</p>
<table class="docutils align-default" id="id4">
<caption><span class="caption-number">Table 33 </span><span class="caption-text">KISS Stream Data Frame</span><a class="headerlink" href="#id4" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Frame Size</p></th>
<th class="head"><p>Contents</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>6</p></td>
<td><p>LICH (48 bits)</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Frame number and EOS flag</p></td>
</tr>
<tr class="row-even"><td><p>16</p></td>
<td><p>Payload</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>M17 CRC of frame number and payload</p></td>
</tr>
</tbody>
</table>
<p>The TNC is responsible for FEC-encoding both the LICH the payload, as well
as interleaving, decorrelation, and baseband modulation.</p>
</div>
<div class="section" id="timing-constraints">
<h3>Timing Constraints<a class="headerlink" href="#timing-constraints" title="Permalink to this headline"></a></h3>
<p>Streaming mode provides additional timing constraints on both host to TNC
transfers and on TNC to host transfers.  Payload frames must arrive every
40ms and must have a jitter below 40ms.  In general, it is expected that the
TNC has up to 2 frames buffered (buffering occurs while sending the preamble
and link setup frames), it should be able to keep the transmit buffers filled
with packet jitter of 40ms.</p>
<p>The TNC must stop transmitting if the transmit buffers are empty.  The TNC
communicates that it has stopped transmitting early (before seeing a frame
with the <strong>end of stream</strong> indicator set) by sending an empty data frame to
the host.</p>
</div>
<div class="section" id="tnc-to-host-transfers">
<h3>TNC to Host Transfers<a class="headerlink" href="#tnc-to-host-transfers" title="Permalink to this headline"></a></h3>
<p>TNC to host transfers are similar in that the TNC first sends the 30-byte
link setup frame received to the host, followed by a stream of 26-byte data
frames as described above.  These are sent using <strong>KISS port</strong> 2.</p>
<p>The TNC must send the link setup frame first.  This means that tne TNC must
be able to decode LICH segments and assemble a valid link setup frame before
it sends the first data frame.  The TNC will only send a link setup frame
with a valid CRC to the host.  After the link setup frame is sent, the TNC
ignores the CRC and sends all valid frames (those received after a valid
sync word) to the host.  If the stream is lost before seeing an end-of-stream
flag, the TNC sends a 0-byte data frame to indicate loss of signal.</p>
<p>The TNC must then re-acquire the signal by decoding a valid link setup frame
from the LICH in order to resume sending to the host.</p>
</div>
<div class="section" id="busy-channel-lockout">
<h3>Busy Channel Lockout<a class="headerlink" href="#busy-channel-lockout" title="Permalink to this headline"></a></h3>
<p>The TNC implements <strong>busy channel lockout</strong> by enabling half-duplex mode on
the TNC, and disables <strong>busy channel lockout</strong> by enabling full-duplex mode.
When busy channel lockout occurs, the TNC keeps the link setup frame and
discards all data frames until the channel is available.  It then sends the
preamble, link setup frame, and starts sending the data frames as they are
received.</p>
<p>Note: BCL will be apparent to a receiver as the first frame received after
the link setup frame will not start with frame number 0.</p>
</div>
<div class="section" id="id2">
<h3>Limitations<a class="headerlink" href="#id2" title="Permalink to this headline"></a></h3>
<p>Information is lost by having the TNC decode the LICH.  It is not possible to
communicate to the host that the LICH bytes are known to be invalid.</p>
<p>Should we have the TNC signal the host by dropping known invalid LICH segments?
The host can tell that the LICH is missing by looking at the frame size.</p>
</div>
</div>
<div class="section" id="mixing-modes">
<h2>Mixing Modes<a class="headerlink" href="#mixing-modes" title="Permalink to this headline"></a></h2>
<p>An M17 KISS TNC need not keep track of state across distinct TNC ports.  Packet
transfers are sent one packet at a time.  It is OK to send to port 0 and port 1
in subsequent transfers.  It is also OK to send a packet followed immediately
by a voice streams.  As mentioned earlier, it is a protocol violation to sent
a KISS frame to any other port while a stream is active.  However, a packet
can be sent immediately following a voice stream (after EOS is sent).</p>
<div class="section" id="back-to-back-transfers">
<h3>Back-to-back Transfers<a class="headerlink" href="#back-to-back-transfers" title="Permalink to this headline"></a></h3>
<p>The TNC is expected to detect back-to-back transfers from the host, even across
different KISS ports, and suppress the generation of the preamble.</p>
<p>For example, a packet containing APRS data sent immediately on PTT key-up
should be sent immediately after the EOS frame.</p>
<p>Back-to-back transfers are common for packet communication where the
<strong>window size</strong> determines the number of unacknowledged frames which may be
outstanding (unacknowledged). Packet applications will frequently send
back-to-back packets (up to <strong>window size</strong> packets) before waiting for
the remote end to send ACKs for each of the packets.</p>
</div>
</div>
<div class="section" id="implementation-details">
<h2>Implementation Details<a class="headerlink" href="#implementation-details" title="Permalink to this headline"></a></h2>
<div class="section" id="polarity">
<h3>Polarity<a class="headerlink" href="#polarity" title="Permalink to this headline"></a></h3>
<p>One of the issues that must be addressed by the TNC designer, and one which
the KISS protocol offers no ready solution for, is the issue of polarity.</p>
<p>A TNC must interface with a RF transceiver for a complete M17 physical layer
implementation.  RF transceivers may have different polarity for their
TX and RX paths.</p>
<p>M17 defines that the +3 symbol is transmitted with a +2.4 kHz deviation
(2.4 kHz above the carrier).  <strong>Normal polarity</strong> in a transceiver results
in a positive voltage driving the frequency higher and a lower voltage
driving the frequency lower.  <strong>Reverse polarity</strong> is the opposite.  A
higher voltage drives the frequency lower.</p>
<p>On the receive side the same issue exists.  <strong>Normal polarity</strong> results
in a positive voltage output when the received signal is above the carrier
frequency. <strong>Reverse polarity</strong> results in a positive voltage when the
frequency is below the carrier.</p>
<p>Just as with transmitter deviation levels and received signal levels, the
polarity of the transmit and receive path must be adjustable on a 4-FSK
modem.  The way these adjustments are made to the TNC are not addressed
by the KISS specification.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ip_encapsulation.html" class="btn btn-neutral float-left" title="M17 Internet Protocol (IP) Networking" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Project M17.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>